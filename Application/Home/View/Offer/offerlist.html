<include file="public/head" />
<script type="text/javascript">
    pSet('2');
</script>
<div class="bdiv cont">
    <div class="content">
        <div class="list">
            <table>
                <tr>
                    <th width="30"></th>
                    <th colspan="2" width="170">品名：　　玉米</th>
                    <th colspan="7">等级：　　一等</th>
                </tr>
                <tr>
                    <th></th>
                    <th colspan="10">年份：　　
                        <if condition="$_GET['gy_id']">
                            <a href="/Home/Offer/offerList">全部</a>　　
                            <else />
                            <label class="hotitem">全部</label>　　
                        </if>
                        <volist name="year" id="vo">
                            <if condition="$_GET['gy_id'] eq $vo['gy_id']">
                                <label class="hotitem">{$vo.gy_id}</label>　　
                                <else />
                                <a  value="{$vo.gy_id}" class="gy_click" href="#">{$vo.gy_id}</a>　　
                            </if>
                        </volist>
                    </th>
                </tr>
                <tr>
                    <th></th>
                    <th colspan="10">产地：　　
                        <if condition="$_GET['gp_id']">
                            <a href="/Home/Sell/sellBillList">全部</a>　　
                            <else/>
                            <label class="hotitem">全部</label>　　
                        </if>
                        <volist name="place" id="vo">
                            <if condition="$_GET['gp_id'] eq $vo['gp_id']">
                                <label class="hotitem">{$vo.gp_name}</label>　　
                                <else/>
                                <a value="{$vo.gp_id}" class="gp_click" href="#">{$vo.gp_name}</a>　　
                            </if>
                        </volist>
                    </th>
                </tr>
                <tr>
                    <th></th>
                    <th colspan="10">排序：　　
                        <if condition="$_GET['t_name'] eq 'f_rz' AND $_GET['t_order'] eq 'desc' ">
                            <a href="#" t_order="desc" t_name="f_rz" class="clkitem">容重<img src="/Public/fu/img/ob_d.png"></a>　　
                            <else/>
                            <a href="#" t_order="asc" t_name="f_rz" class="clkitem">容重<img src="/Public/fu/img/ob_a.png"></a>　　
                        </if>

                        <if condition="$_GET['t_name'] eq 'f_weig' AND $_GET['t_order'] eq 'desc' ">
                            <a href="#" t_order="desc" t_name="f_weig" class="clkitem">净重<img src="/Public/fu/img/ob_d.png"></a>　　
                            <else/>
                            <a href="#" t_order="asc" t_name="f_weig" class="clkitem">净重<img src="/Public/fu/img/ob_a.png"></a>　　
                        </if>

                        <if condition="$_GET['t_name'] eq 'f_pric' AND $_GET['t_order'] eq 'desc' ">
                            <a href="#" t_order="desc" t_name="f_pric" class="clkitem">单价<img src="/Public/fu/img/ob_d.png"></a>　　
                            <else/>
                            <a href="#" t_order="asc" t_name="f_pric" class="clkitem">单价<img src="/Public/fu/img/ob_a.png"></a>　　
                        </if>

                        <if condition="$_GET['t_name'] eq 'f_ctime' AND $_GET['t_order'] eq 'desc' ">
                            <a href="#" t_order="desc" t_name="f_ctime" class="clkitem">上架时间<img src="/Public/fu/img/ob_d.png"></a>　　
                            <else/>
                            <a href="#" t_order="asc" t_name="f_ctime" class="clkitem">上架时间<img src="/Public/fu/img/ob_a.png"></a>　　
                        </if>
                    </td>
                </tr>
                <if condition="$info['list']">
                <volist name="info.list" id="vo">
                <tr onmouseover="this.style['background']='#F0ECE1';"  onmouseout="this.style['background']='#FFF';">
                    <td></td>
                    <td width="60"><b>求购:</b></td>
                    <td width="110">容重：{$vo.f_rz}g/l</td>
                    <td width="110">净重：{$vo.f_weig}吨</td>
                    <td width="100">{$vo.f_pric}元/吨</td>
                    <td width="200">{$vo.f_ctime|date='Y年m月d日 H:i:s',###}</td>
                    <td>{$vo.f_name}</td>
                    <td>{$vo.f_year}年</td>
                    <td>{$vo.f_place}</td>
                    <td>{$vo.f_level}</td>
                    <td width="100"><a href="/Home/Sell/sellBill/f_id={$vo.f_id}"><我有粮源></a></td>
                </tr>
                </volist>
                    <else/>
                    <tr onmouseover="this.style['background']='#F0ECE1';"  onmouseout="this.style['background']='#FFF';">
                        <td></td>
                        <td width="60">暂无数据</td>
                        <td width="110"></td>
                        <td width="110"></td>
                        <td width="100"></td>
                        <td width="200"></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td width="100"></td>
                    </tr>
                </if>
            </table>
            <div class="list_page">
              {$info.page}
            </div>
        </div>
    </div>
</div>
<include file="public/foot" />
<script type="text/javascript" src="/Public/bootstrap/js/jquery.min.js"></script>
<script type="text/javascript">
    function getUrlParam(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
        var r = window.location.search.substr(1).match(reg);  //匹配目标参数
        if (r != null) return unescape(r[2]); return null; //返回参数值
    }
    function isEmpty(v) {
        switch (typeof v) {
            case 'undefined':
                return true;
            case 'string':
                if (v.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g, '').length == 0) return true;
                break;
            case 'boolean':
                if (!v) return true;
                break;
            case 'number':
                if (0 === v || isNaN(v)) return true;
                break;
            case 'object':
                if (null === v || v.length === 0) return true;
                for (var i in v) {
                    return false;
                }
                return true;
        }
        return false;
    }

    var url = '/Home/Offer/offerList?';
    // 排序
    $(".clkitem").on('click tap',function(){
        // 设置url  有年份和产地时 把年份和产地参数带上
        var url_gy_id = getUrlParam('gy_id');
        var url_gp_id = getUrlParam('gp_id');
        if (!isEmpty(url_gy_id)) {
            url = url + '&gy_id=' + url_gy_id;
        }

        if (!isEmpty(url_gp_id)) {
            url = url + '&gp_id=' + url_gp_id;
        }

        // 重新设置排序属性
        var t_name = $(this).attr('t_name');
        var t_order = $(this).attr('t_order');
        if (t_order == 'desc') {
            s_order = 'asc';
        }
        else {
            s_order = 'desc';
        }
        // 拼链接
        window.location.href = url + "&t_name=" + t_name + "&t_order=" + s_order ;
    });

    //年份
    $(".gy_click").on('click tap',function(){
        // 地点链接
        var url_gp_id = getUrlParam('gp_id');
        if (!isEmpty(url_gp_id)) {
            url = url + '&gp_id=' + url_gp_id;
        }

        //排序链接
        var url_t_name = getUrlParam('t_name');
        if (!isEmpty(url_t_name)) {
            url = url + '&t_name=' + url_t_name;
        }

        var url_t_order = getUrlParam('t_order');
        if (!isEmpty(url_t_order)) {
            url = url + '&t_order=' + url_t_order;
        }

        var gy_id = $(this).attr('value');
        if (!isEmpty(gy_id)) {
            window.location.href = url + "&gy_id=" + gy_id;
        }
        else {
            window.location.href = url;
        }
    })

    // 产地
    $(".gp_click").on('click tap', function() {
        // 年份链接
        var url_gy_id = getUrlParam('gy_id');
        if (url_gy_id != null) {
            url = url + '&gy_id=' + url_gy_id;
        }

        //排序链接
        var url_t_name = getUrlParam('t_name');
        if (url_t_name != null) {
            url = url + '&t_name=' + url_t_name;
        }

        var url_t_order = getUrlParam('t_order');
        if (url_t_order != null) {
            url = url + '&t_order=' + url_t_order;
        }

        var gp_id = $(this).attr('value');
        if (!isEmpty(gp_id)) {
            window.location.href = url + "&gp_id=" + gp_id;
        }
        else {
            window.location.href = url;
        }
    })
</script>